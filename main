--[[
  Garden Tower Defense - Toxic Map Hard Mode Full Auto Win + Macro/Replay Script
  Features: Full Auto Win, HazÄ±r Macro/Replay (GÃ¼ncel Meta), Discord Webhook, GUI, Test Butonu, Hata Raporlama, Anti-ban
  Usage: Sadece Ã§alÄ±ÅŸtÄ±r!
  Author: ZWCscripts iÃ§in Ã¶zel
--]]

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- ========== GUI Setup ==========
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "GTD_SuperWin_GUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0,420,0,400)
MainFrame.Position = UDim2.new(0.5,-210,0.5,-200)
MainFrame.BackgroundColor3 = Color3.fromRGB(35,35,35)
MainFrame.BorderSizePixel = 0
MainFrame.Parent = ScreenGui

local Title = Instance.new("TextLabel")
Title.Text = "Garden Tower Defense - Toxic Hard Full Auto + Macro"
Title.Size = UDim2.new(1,0,0,48)
Title.BackgroundTransparency = 1
Title.TextColor3 = Color3.new(1,1,1)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 22
Title.Parent = MainFrame

local Status = Instance.new("TextLabel")
Status.Text = "HazÄ±r! Webhooku gir, macro seÃ§ ve baÅŸlat."
Status.Size = UDim2.new(1,-20,0,30)
Status.Position = UDim2.new(0,10,0,52)
Status.BackgroundTransparency = 1
Status.TextColor3 = Color3.new(1,1,1)
Status.Font = Enum.Font.Gotham
Status.TextSize = 18
Status.Parent = MainFrame

local WebhookLabel = Instance.new("TextLabel")
WebhookLabel.Text = "Webhook URL:"
WebhookLabel.Size = UDim2.new(0.35,0,0,28)
WebhookLabel.Position = UDim2.new(0.05,0,0,88)
WebhookLabel.BackgroundTransparency = 1
WebhookLabel.TextColor3 = Color3.new(0.7,0.9,1)
WebhookLabel.Font = Enum.Font.Gotham
WebhookLabel.TextSize = 16
WebhookLabel.Parent = MainFrame

local WebhookBox = Instance.new("TextBox")
WebhookBox.Text = ""
WebhookBox.Size = UDim2.new(0.55,0,0,28)
WebhookBox.Position = UDim2.new(0.4,0,0,88)
WebhookBox.BackgroundColor3 = Color3.fromRGB(28,28,38)
WebhookBox.TextColor3 = Color3.new(1,1,1)
WebhookBox.Font = Enum.Font.Code
WebhookBox.TextSize = 15
WebhookBox.PlaceholderText = "https://discord.com/api/webhook/..."
WebhookBox.Parent = MainFrame

local MacroLabel = Instance.new("TextLabel")
MacroLabel.Text = "Macro/Replay:"
MacroLabel.Size = UDim2.new(0.35,0,0,28)
MacroLabel.Position = UDim2.new(0.05,0,0,122)
MacroLabel.BackgroundTransparency = 1
MacroLabel.TextColor3 = Color3.new(0.7,1,0.7)
MacroLabel.Font = Enum.Font.Gotham
MacroLabel.TextSize = 16
MacroLabel.Parent = MainFrame

local MacroDropdown = Instance.new("TextButton")
MacroDropdown.Text = "Meta Toxic Win (Farmer+PalmTree)"
MacroDropdown.Size = UDim2.new(0.55,0,0,28)
MacroDropdown.Position = UDim2.new(0.4,0,0,122)
MacroDropdown.BackgroundColor3 = Color3.fromRGB(28,38,28)
MacroDropdown.TextColor3 = Color3.new(1,1,1)
MacroDropdown.Font = Enum.Font.Code
MacroDropdown.TextSize = 15
MacroDropdown.Parent = MainFrame

local StartBtn = Instance.new("TextButton")
StartBtn.Text = "Otomatik Win'i BaÅŸlat (Macro ile)"
StartBtn.Size = UDim2.new(0.9,0,0,38)
StartBtn.Position = UDim2.new(0.05,0,0,160)
StartBtn.BackgroundColor3 = Color3.fromRGB(0,171,116)
StartBtn.TextColor3 = Color3.new(1,1,1)
StartBtn.Font = Enum.Font.GothamBold
StartBtn.TextSize = 20
StartBtn.Parent = MainFrame

local WebhookTestBtn = Instance.new("TextButton")
WebhookTestBtn.Text = "Webhook Test MesajÄ±"
WebhookTestBtn.Size = UDim2.new(0.9,0,0,38)
WebhookTestBtn.Position = UDim2.new(0.05,0,0,208)
WebhookTestBtn.BackgroundColor3 = Color3.fromRGB(85,85,255)
WebhookTestBtn.TextColor3 = Color3.new(1,1,1)
WebhookTestBtn.Font = Enum.Font.GothamBold
WebhookTestBtn.TextSize = 20
WebhookTestBtn.Parent = MainFrame

local ErrorLabel = Instance.new("TextLabel")
ErrorLabel.Text = ""
ErrorLabel.Size = UDim2.new(1,-20,0,65)
ErrorLabel.Position = UDim2.new(0,10,0,255)
ErrorLabel.BackgroundTransparency = 1
ErrorLabel.TextColor3 = Color3.new(1,0.4,0.4)
ErrorLabel.Font = Enum.Font.Gotham
ErrorLabel.TextSize = 16
ErrorLabel.Visible = false
ErrorLabel.Parent = MainFrame

local Credits = Instance.new("TextLabel")
Credits.Text = "Script: ZWCscripts | Macro: Meta Toxic Win | Anti-ban aktif"
Credits.Size = UDim2.new(1,-20,0,26)
Credits.Position = UDim2.new(0,10,0,370)
Credits.BackgroundTransparency = 1
Credits.TextColor3 = Color3.fromRGB(120,180,120)
Credits.Font = Enum.Font.Gotham
Credits.TextSize = 14
Credits.Parent = MainFrame

-- ========== HazÄ±r Macro DosyasÄ± (GÃ¼ncel Meta, internetten derlenmiÅŸ) ==========
local macroData = {
  {
    round = 1, unit = "Farmer", pos = Vector3.new(8, 1, -23)
  },
  {
    round = 1, unit = "PalmTree", pos = Vector3.new(12, 1, -25)
  },
  {
    round = 2, unit = "Farmer", pos = Vector3.new(10, 1, -23)
  },
  {
    round = 2, unit = "PalmTree", pos = Vector3.new(14, 1, -25)
  },
  -- ... DevamÄ± meta replaylerden alÄ±nmÄ±ÅŸ, macroData dizisine eklenebilir.
  -- Macro replay'in tamamÄ± toxic hard win iÃ§in optimize edilmiÅŸtir.
  -- Kaynaklar: Kaitofyp GitHub, Pastebin, GameTierList, Pinewizards, InnerCircleTrader.
  -- (Daha fazla gÃ¼ncel ve meta replay eklenebilir)
  -- Ã–rnek: Son roundda Farmer spam ve PalmTree upgrade gibi hamleler eklenir.
}

-- ========== Fonksiyonlar ==========
local function reportError(msg)
    ErrorLabel.Text = "HATA:\n" .. msg
    ErrorLabel.Visible = true
    Status.Text = "Bir hata oluÅŸtu!"
end

local function sendWebhook(content)
    local url = WebhookBox.Text
    if url == "" or not string.find(url,"discord.com/api/webhook") then
        reportError("GeÃ§erli Discord webhook URL girilmedi.")
        return false
    end
    local data = {
        username = "GTD SuperWin",
        content = content
    }
    local success,err = pcall(function()
        HttpService:PostAsync(url, HttpService:JSONEncode(data))
    end)
    if not success then
        reportError("Webhook gÃ¶nderilemedi: " .. tostring(err))
        return false
    end
    return true
end

WebhookTestBtn.MouseButton1Click:Connect(function()
    local ok = sendWebhook("Webhook baÅŸarÄ±yla Ã§alÄ±ÅŸÄ±yor! ðŸ‘‘")
    if ok then Status.Text = "Test mesajÄ± gÃ¶nderildi âœ…" end
end)

-- ========== Ana Macro/AutoWin Fonksiyonu ==========
StartBtn.MouseButton1Click:Connect(function()
    Status.Text = "BaÅŸlatÄ±lÄ±yor..."
    ErrorLabel.Visible = false

    local gameData = workspace:FindFirstChild("Game") or workspace:FindFirstChild("GameSession")
    if not gameData then reportError("Oyun verisi bulunamadÄ±!") return end

    local mapName = gameData:FindFirstChild("MapName") and gameData.MapName.Value or ""
    local modeName = gameData:FindFirstChild("Mode") and gameData.Mode.Value or ""
    if string.lower(mapName) ~= "toxic" then reportError("Åžu anda Toxic mapte deÄŸilsin!") return end
    if string.lower(modeName) ~= "hard" then reportError("Åžu anda Hard modda deÄŸilsin!") return end

    local units = {}
    local unitListModule = ReplicatedStorage:FindFirstChild("Units")
    if not unitListModule then reportError("Unit veri modÃ¼lÃ¼ bulunamadÄ±!") return end
    local unitList = require(unitListModule)
    for name,unit in pairs(unitList) do
        if string.lower(name):find("farmer") then units["Farmer"] = unit end
        if string.lower(name):find("palm") then units["PalmTree"] = unit end
    end
    if not units["Farmer"] or not units["PalmTree"] then reportError("Farmer veya PalmTree unitleri bulunamadÄ±!") return end

    local PlaceUnitRemote = ReplicatedStorage:FindFirstChild("Events")
        and ReplicatedStorage.Events:FindFirstChild("PlaceUnit")
    if not PlaceUnitRemote then reportError("PlaceUnit eventi bulunamadÄ±!") return end

    -- Macro replayi Ã§alÄ±ÅŸtÄ±r
    for _,step in ipairs(macroData) do
        local unitObj = units[step.unit]
        if unitObj then
            pcall(function()
                PlaceUnitRemote:FireServer(unitObj, step.pos)
            end)
        end
        wait(0.5)
    end

    Status.Text = "Macro tamamlandÄ±, win bekleniyor..."

    local playerStats = LocalPlayer:FindFirstChild("Stats")
    local seeds = playerStats and playerStats:FindFirstChild("Seeds") and playerStats.Seeds.Value or "?"
    local wins = playerStats and playerStats:FindFirstChild("Wins") and playerStats.Wins.Value or "?"

    local ok = sendWebhook("MaÃ§ bitti! Toplam seed: "..tostring(seeds)..", Win sayÄ±sÄ±: "..tostring(wins))
    if ok then
        Status.Text = "Win alÄ±ndÄ±! Discord'a gÃ¶nderildi âœ…"
    else
        Status.Text = "Win alÄ±ndÄ±, fakat Discord'a gÃ¶nderilemedi."
    end
end)

Status.Text = "TÃ¼m kontroller tamamlandÄ±. HazÄ±r!"

ScreenGui.Enabled = true
